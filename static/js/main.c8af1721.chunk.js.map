{"version":3,"sources":["unit/const.js","unit/index.js","unit/reducerType.js","reducers/pause/index.js","unit/music.js","reducers/music/index.js","reducers/matrix/index.js","reducers/next/index.js","unit/block.js","reducers/cur/index.js","reducers/startLines/index.js","reducers/max/index.js","reducers/points/index.js","reducers/speedStart/index.js","reducers/speedRun/index.js","reducers/lock/index.js","reducers/clearLines/index.js","reducers/reset/index.js","reducers/drop/index.js","reducers/keyboard/drop.js","reducers/keyboard/down.js","reducers/keyboard/left.js","reducers/keyboard/right.js","reducers/keyboard/rotate.js","reducers/keyboard/reset.js","reducers/keyboard/music.js","reducers/keyboard/pause.js","reducers/keyboard/index.js","reducers/focus/index.js","reducers/index.js","store/index.js","actions/index.js","actions/keyboard.js","control/states.js","components/matrix/index.js","components/decorate/index.js","components/number/index.js","components/next/index.js","components/music/index.js","components/pause/index.js","components/point/index.js","components/logo/index.js","components/keyboard/button/index.js","unit/event.js","control/todo/index.js","control/todo/left.js","control/todo/down.js","control/todo/rotate.js","control/todo/right.js","control/todo/space.js","control/todo/r.js","control/todo/p.js","control/todo/s.js","components/keyboard/index.js","Tetris.js","App.js","control/index.js","index.js"],"names":["blockShape","I","L","J","Z","S","O","T","origin","blockType","Object","keys","speeds","delays","fillLine","blankLine","blankMatrix","matrix","i","push","List","clearPoints","lastRecord","data","localStorage","getItem","window","btoa","atob","decodeURIComponent","JSON","parse","e","console","error","transform","body","document","filter","undefined","style","hiddenProperty","names","length","visibilityChangeEvent","replace","isFocus","getNextType","len","Math","floor","random","want","next","xy","shape","horizontal","get","size","every","m","k1","n","k2","isClear","clearLines","forEach","k","PAUSE","MUSIC","MATRIX","NEXT_BLOCK","MOVE_BLOCK","START_LINES","MAX","POINTS","SPEED_START","SPEED_RUN","LOCK","CLEAR_LINES","RESET","DROP","KEY_DROP","KEY_DOWN","KEY_LEFT","KEY_RIGHT","KEY_ROTATE","KEY_RESET","KEY_MUSIC","KEY_PAUSE","FOCUS","initState","pause","state","action","type","reducerType","AudioContext","webkitAudioContext","mozAudioContext","oAudioContext","msAudioContext","hasWebAudioAPI","location","protocol","indexOf","music","url","context","req","XMLHttpRequest","open","responseType","onload","decodeAudioData","response","buf","getSource","source","createBufferSource","buffer","connect","destination","killStart","start","store","getState","clear","fall","gameover","rotate","move","send","Array","isArray","map","Block","option","this","rotateIndex","timeStamp","Date","now","result","index","set","tempK","nextXy","nextRotateIndex","cur","isNaN","parseInt","startLines","max","points","speedStart","speedRun","lock","reset","drop","reducer","keyboardReducer","combineReducers","down","left","right","focus","rootReducer","keyboard","createStore","devToolsExtension","nextBlock","moveBlock","states","fallInterval","dispatchPoints","dispatch","actions","startMatrix","getLine","min","count","line","splice","unshift","getStartMatrix","auto","timeout","out","clearTimeout","setTimeout","nextAround","stopDownTrigger","addPoints","some","isOver","overStart","isPause","lines","newMatrix","speedAdd","speedNow","overEnd","point","t","Matrix","animateColor","overState","nextProps","clears","overs","setState","clearAnimate","over","props","immutable","is","color","anima","callback","getResult","exLine","bind","className","p","key","classnames","c","d","React","Component","Decorate","cn","width","render","formate","num","split","Number","time_count","time","clock","timeInterval","number","hour","getHours","getMinutes","sec","getSeconds","concat","statics","defaultProps","empty","Next","block","build","arr","Music","bg","Pause","showPause","setShake","bool","setInterval","clearInterval","Point","label","onChange","toggle","Logo","display","animate","func","delay","show","hide","eyes","delay1","delay2","dra","run","Button","active","top","position","arrow","ref","dom","eventName","o","once","begin","interval","loop","event","remain","speed","up","space","bottom","r","s","Keyboard","touchEventCatch","mouseDownEventCatch","addEventListener","preventDefault","todo","filling","Immutable","marginTop","dom_rotate","dom_down","dom_left","dom_right","dom_space","dom_r","dom_s","dom_p","Tetris","w","documentElement","clientWidth","h","clientHeight","resize","scale","css","paddingTop","paddingBottom","App","keydownActive","osname","platform","activePanel","id","IOS","37","38","39","40","32","83","82","80","boardKeys","metaKey","keyCode","subscribe","toJS","stringify","encodeURIComponent","setItem","ReactDOM","getElementById"],"mappings":"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","file":"static/js/main.c8af1721.chunk.js","sourcesContent":["import { List } from 'immutable';\r\n\r\nexport const blockShape = {\r\n  I: [\r\n    [1, 1, 1, 1],\r\n  ],\r\n  L: [\r\n    [0, 0, 1],\r\n    [1, 1, 1],\r\n  ],\r\n  J: [\r\n    [1, 0, 0],\r\n    [1, 1, 1],\r\n  ],\r\n  Z: [\r\n    [1, 1, 0],\r\n    [0, 1, 1],\r\n  ],\r\n  S: [\r\n    [0, 1, 1],\r\n    [1, 1, 0],\r\n  ],\r\n  O: [\r\n    [1, 1],\r\n    [1, 1],\r\n  ],\r\n  T: [\r\n    [0, 1, 0],\r\n    [1, 1, 1],\r\n  ],\r\n};\r\n\r\nexport const origin = {\r\n  I: [[-1, 1], [1, -1]],\r\n  L: [[0, 0]],\r\n  J: [[0, 0]],\r\n  Z: [[0, 0]],\r\n  S: [[0, 0]],\r\n  O: [[0, 0]],\r\n  T: [[0, 0], [1, 0], [-1, 1], [0, -1]],\r\n};\r\n\r\nexport const blockType = Object.keys(blockShape);\r\n\r\nexport const speeds = [800, 650, 500, 370, 250, 160];\r\n\r\nexport const delays = [50, 60, 70, 80, 90, 100];\r\n\r\nexport const fillLine = [1, 1, 1, 1, 1, 1, 1, 1, 1, 1];\r\n\r\nexport const blankLine = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0];\r\n\r\nexport const blankMatrix = (() => {\r\n  const matrix = [];\r\n  for (let i = 0; i < 20; i++) {\r\n    matrix.push(List(blankLine));\r\n  }\r\n  return List(matrix);\r\n})();\r\n\r\nexport const clearPoints = [100, 300, 700, 1500];\r\n\r\nexport const StorageKey = 'REACT_TETRIS';\r\n\r\nexport const lastRecord = (() => { // 上一把的状态\r\n  let data = localStorage.getItem(StorageKey);\r\n  if (!data) {\r\n    return false;\r\n  }\r\n  try {\r\n    if (window.btoa) {\r\n      data = atob(data);\r\n    }\r\n    data = decodeURIComponent(data);\r\n    data = JSON.parse(data);\r\n  } catch (e) {\r\n    if (window.console || window.console.error) {\r\n      window.console.error('Read record error:', e);\r\n    }\r\n    return false;\r\n  }\r\n  return data;\r\n})();\r\n\r\nexport const maxPoint = 999999;\r\n\r\nexport const transform = (function () {\r\n  const trans = ['transform', 'webkitTransform', 'msTransform', 'mozTransform', 'oTransform'];\r\n  const body = document.body;\r\n  return trans.filter((e) => body.style[e] !== undefined)[0];\r\n}());\r\n\r\nexport const eachLines = 20;\r\n\r\nexport const getParam = (param) => {\r\n  const r = new RegExp(`\\\\?(?:.+&)?${param}=(.*?)(?:&.*)?$`);\r\n  const m = window.location.toString().match(r);\r\n  return m ? decodeURI(m[1]) : '';\r\n};\r\n","import { blockType, StorageKey } from './const';\r\n\r\nexport const hiddenProperty = (() => {\r\n  let names = [\r\n    'hidden',\r\n    'webkitHidden',\r\n    'mozHidden',\r\n    'msHidden',\r\n  ];\r\n  names = names.filter((e) => (e in document));\r\n  return names.length > 0 ? names[0] : false;\r\n})();\r\n\r\nexport const visibilityChangeEvent = (() => {\r\n  if (!hiddenProperty) {\r\n    return false;\r\n  }\r\n  return hiddenProperty.replace(/hidden/i, 'visibilitychange');\r\n})();\r\n\r\nexport const isFocus = () => {\r\n  if (!hiddenProperty) {\r\n    return true;\r\n  }\r\n  return !document[hiddenProperty];\r\n};\r\n\r\n\r\nexport const getNextType = () => {\r\n  const len = blockType.length;\r\n  return blockType[Math.floor(Math.random() * len)];\r\n};\r\n\r\nexport const want = (next, matrix) => {\r\n  const xy = next.xy;\r\n  const shape = next.shape;\r\n  const horizontal = shape.get(0).size;\r\n  return shape.every((m, k1) => (\r\n      m.every((n, k2) => {\r\n        if (xy[1] < 0) { // left\r\n          return false;\r\n        }\r\n        if (xy[1] + horizontal > 10) { // right\r\n          return false;\r\n        }\r\n        if (xy[0] + k1 < 0) { // top\r\n          return true;\r\n        }\r\n        if (xy[0] + k1 >= 20) { // bottom\r\n          return false;\r\n        }\r\n        if (n) {\r\n          if (matrix.get(xy[0] + k1).get(xy[1] + k2)) {\r\n            return false;\r\n          }\r\n          return true;\r\n        }\r\n        return true;\r\n      })\r\n  ));\r\n};\r\n\r\nexport const isClear = (matrix) => {\r\n  const clearLines = [];\r\n  matrix.forEach((m, k) => {\r\n    if (m.every(n => !!n)) {\r\n      clearLines.push(k);\r\n    }\r\n  });\r\n  if (clearLines.length === 0) {\r\n    return false;\r\n  }\r\n  return clearLines;\r\n};\r\n\r\nexport const isOver = (matrix) => {\r\n  return matrix.get(0).some(n => !!n);\r\n};\r\n\r\nexport const subscribeRecord = (store) => {\r\n  store.subscribe(() => {\r\n    let data = store.getState().toJS();\r\n    if (data.lock) {\r\n      return;\r\n    }\r\n    data = JSON.stringify(data);\r\n    data = encodeURIComponent(data);\r\n    if (window.btoa) {\r\n      data = btoa(data);\r\n    }\r\n    localStorage.setItem(StorageKey, data);\r\n  });\r\n};\r\n\r\nexport const isMobile = () => {\r\n  const ua = navigator.userAgent;\r\n  const android = /Android (\\d+\\.\\d+)/.test(ua);\r\n  const iphone = ua.indexOf('iPhone') > -1;\r\n  const ipod = ua.indexOf('iPod') > -1;\r\n  const ipad = ua.indexOf('iPad') > -1;\r\n  const nokiaN = ua.indexOf('NokiaN') > -1;\r\n  return android || iphone || ipod || ipad || nokiaN;\r\n}\r\n","export const PAUSE = 'PAUSE';\r\nexport const MUSIC = 'MUSIC';\r\nexport const MATRIX = 'MATRIX';\r\nexport const NEXT_BLOCK = 'NEXT_BLOCK';\r\nexport const MOVE_BLOCK = 'MOVE_BLOCK';\r\nexport const START_LINES = 'START_LINES';\r\nexport const MAX = 'MAX';\r\nexport const POINTS = 'POINTS';\r\nexport const SPEED_START = 'SPEED_START';\r\nexport const SPEED_RUN = 'SPEED_RUN';\r\nexport const LOCK = 'LOCK';\r\nexport const CLEAR_LINES = 'CLEAR_LINES';\r\nexport const RESET = 'RESET';\r\nexport const DROP = 'DROP';\r\nexport const KEY_DROP = 'KEY_DROP';\r\nexport const KEY_DOWN = 'KEY_DOWN';\r\nexport const KEY_LEFT = 'KEY_LEFT';\r\nexport const KEY_RIGHT = 'KEY_RIGHT';\r\nexport const KEY_ROTATE = 'KEY_ROTATE';\r\nexport const KEY_RESET = 'KEY_RESET';\r\nexport const KEY_MUSIC = 'KEY_MUSIC';\r\nexport const KEY_PAUSE = 'KEY_PAUSE';\r\nexport const FOCUS = 'FOCUS';\r\n","import * as reducerType from '../../unit/reducerType';\r\nimport { lastRecord } from '../../unit/const';\r\n\r\nconst initState = lastRecord && lastRecord.pause !== undefined ? !!lastRecord.pause : false;\r\nconst pause = (state = initState, action) => {\r\n  switch (action.type) {\r\n    case reducerType.PAUSE:\r\n      return action.data;\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default pause;\r\n","import store from '../store';\r\n\r\nconst AudioContext = (\r\n  window.AudioContext ||\r\n  window.webkitAudioContext ||\r\n  window.mozAudioContext ||\r\n  window.oAudioContext ||\r\n  window.msAudioContext\r\n);\r\n\r\nexport const hasWebAudioAPI = {\r\n  data: !!AudioContext && window.location.protocol.indexOf('http') !== -1,\r\n};\r\n\r\nexport const music = {};\r\n\r\n(() => {\r\n  if (!hasWebAudioAPI.data) {\r\n    return;\r\n  }\r\n  const url = './music/music.mp3';\r\n  const context = new AudioContext();\r\n  const req = new XMLHttpRequest();\r\n  req.open('GET', url, true);\r\n  req.responseType = 'arraybuffer';\r\n\r\n  req.onload = () => {\r\n    context.decodeAudioData(req.response, (buf) => {\r\n      const getSource = () => {\r\n        const source = context.createBufferSource();\r\n        source.buffer = buf;\r\n        source.connect(context.destination);\r\n        return source;\r\n      };\r\n\r\n      music.killStart = () => {\r\n        music.start = () => {};\r\n      };\r\n\r\n      music.start = () => {\r\n        music.killStart();\r\n        if (!store.getState().get('music')) {\r\n          return;\r\n        }\r\n        getSource().start(0, 3.7202, 3.6224);\r\n      };\r\n\r\n      music.clear = () => {\r\n        if (!store.getState().get('music')) {\r\n          return;\r\n        }\r\n        getSource().start(0, 0, 0.7675);\r\n      };\r\n\r\n      music.fall = () => {\r\n        if (!store.getState().get('music')) {\r\n          return;\r\n        }\r\n        getSource().start(0, 1.2558, 0.3546);\r\n      };\r\n\r\n      music.gameover = () => {\r\n        if (!store.getState().get('music')) {\r\n          return;\r\n        }\r\n        getSource().start(0, 8.1276, 1.1437);\r\n      };\r\n\r\n      music.rotate = () => {\r\n        if (!store.getState().get('music')) {\r\n          return;\r\n        }\r\n        getSource().start(0, 2.2471, 0.0807);\r\n      };\r\n\r\n      music.move = () => {\r\n        if (!store.getState().get('music')) {\r\n          return;\r\n        }\r\n        getSource().start(0, 2.9088, 0.1437);\r\n      };\r\n    },\r\n    (error) => {\r\n      if (window.console && window.console.error) {\r\n        window.console.error(`Audio: ${url} read error`, error);\r\n        hasWebAudioAPI.data = false;\r\n      }\r\n    });\r\n  };\r\n\r\n  req.send();\r\n})();\r\n\r\n","import * as reducerType from '../../unit/reducerType';\r\nimport { lastRecord } from '../../unit/const';\r\nimport { hasWebAudioAPI } from '../../unit/music';\r\n\r\nlet initState = lastRecord && lastRecord.music !== undefined ? !!lastRecord.music : true;\r\nif (!hasWebAudioAPI.data) {\r\n  initState = false;\r\n}\r\nconst music = (state = initState, action) => {\r\n  switch (action.type) {\r\n    case reducerType.MUSIC:\r\n      if (!hasWebAudioAPI.data) {\r\n        return false;\r\n      }\r\n      return action.data;\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default music;\r\n","import { List } from 'immutable';\r\nimport * as reducerType from '../../unit/reducerType';\r\nimport { blankMatrix, lastRecord } from '../../unit/const';\r\n\r\nconst initState = lastRecord && Array.isArray(lastRecord.matrix) ?\r\n  List(lastRecord.matrix.map(e => List(e))) : blankMatrix;\r\n\r\nconst matrix = (state = initState, action) => {\r\n  switch (action.type) {\r\n    case reducerType.MATRIX:\r\n      return action.data;\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default matrix;\r\n","import { getNextType } from '../../unit';\r\nimport * as reducerType from '../../unit/reducerType';\r\nimport { lastRecord, blockType } from '../../unit/const';\r\n\r\nconst initState = lastRecord && blockType.indexOf(lastRecord.next) !== -1 ?\r\n  lastRecord.next : getNextType();\r\nconst parse = (state = initState, action) => {\r\n  switch (action.type) {\r\n    case reducerType.NEXT_BLOCK:\r\n      return action.data;\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default parse;\r\n","import { List } from 'immutable';\r\nimport { blockShape, origin } from './const';\r\n\r\nclass Block {\r\n  constructor(option) {\r\n    this.type = option.type;\r\n\r\n    if (!option.rotateIndex) {\r\n      this.rotateIndex = 0;\r\n    } else {\r\n      this.rotateIndex = option.rotateIndex;\r\n    }\r\n\r\n    if (!option.timeStamp) {\r\n      this.timeStamp = Date.now();\r\n    } else {\r\n      this.timeStamp = option.timeStamp;\r\n    }\r\n\r\n    if (!option.shape) { // init\r\n      this.shape = List(blockShape[option.type].map(e => List(e)));\r\n    } else {\r\n      this.shape = option.shape;\r\n    }\r\n\r\n    if (!option.xy) {\r\n      switch (option.type) {\r\n        case 'I': // I\r\n          this.xy = List([0, 3]);\r\n          break;\r\n        case 'L': // L\r\n          this.xy = List([-1, 4]);\r\n          break;\r\n        case 'J': // J\r\n          this.xy = List([-1, 4]);\r\n          break;\r\n        case 'Z': // Z\r\n          this.xy = List([-1, 4]);\r\n          break;\r\n        case 'S': // S\r\n          this.xy = List([-1, 4]);\r\n          break;\r\n        case 'O': // O\r\n          this.xy = List([-1, 4]);\r\n          break;\r\n        case 'T': // T\r\n          this.xy = List([-1, 4]);\r\n          break;\r\n        default:\r\n          break;\r\n      }\r\n    } else {\r\n      this.xy = List(option.xy);\r\n    }\r\n  }\r\n\r\n  rotate() {\r\n    const shape = this.shape;\r\n    let result = List([]);\r\n    shape.forEach(m => m.forEach((n, k) => {\r\n      const index = m.size - k - 1;\r\n      if (result.get(index) === undefined) {\r\n        result = result.set(index, List([]));\r\n      }\r\n      const tempK = result.get(index).push(n);\r\n      result = result.set(index, tempK);\r\n    }));\r\n    const nextXy = [\r\n      this.xy.get(0) + origin[this.type][this.rotateIndex][0],\r\n      this.xy.get(1) + origin[this.type][this.rotateIndex][1],\r\n    ];\r\n    const nextRotateIndex = this.rotateIndex + 1 >= origin[this.type].length ?\r\n      0 : this.rotateIndex + 1;\r\n    return {\r\n      shape: result,\r\n      type: this.type,\r\n      xy: nextXy,\r\n      rotateIndex: nextRotateIndex,\r\n      timeStamp: this.timeStamp,\r\n    };\r\n  }\r\n\r\n  fall(n = 1) {\r\n    return {\r\n      shape: this.shape,\r\n      type: this.type,\r\n      xy: [this.xy.get(0) + n, this.xy.get(1)],\r\n      rotateIndex: this.rotateIndex,\r\n      timeStamp: Date.now(),\r\n    };\r\n  }\r\n\r\n  right() {\r\n    return {\r\n      shape: this.shape,\r\n      type: this.type,\r\n      xy: [this.xy.get(0), this.xy.get(1) + 1],\r\n      rotateIndex: this.rotateIndex,\r\n      timeStamp: this.timeStamp,\r\n    };\r\n  }\r\n\r\n  left() {\r\n    return {\r\n      shape: this.shape,\r\n      type: this.type,\r\n      xy: [this.xy.get(0), this.xy.get(1) - 1],\r\n      rotateIndex: this.rotateIndex,\r\n      timeStamp: this.timeStamp,\r\n    };\r\n  }\r\n}\r\n\r\nexport default Block;\r\n","import { List } from 'immutable';\r\nimport * as reducerType from '../../unit/reducerType';\r\nimport { lastRecord } from '../../unit/const';\r\nimport Block from '../../unit/block';\r\n\r\nconst initState = (() => {\r\n  if (!lastRecord || !lastRecord.cur) {\r\n    return null;\r\n  }\r\n  const cur = lastRecord.cur;\r\n  const option = {\r\n    type: cur.type,\r\n    rotateIndex: cur.rotateIndex,\r\n    shape: List(cur.shape.map(e => List(e))),\r\n    xy: cur.xy,\r\n  };\r\n  return new Block(option);\r\n})();\r\n\r\nconst cur = (state = initState, action) => {\r\n  switch (action.type) {\r\n    case reducerType.MOVE_BLOCK:\r\n      return action.data;\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default cur;\r\n","import * as reducerType from '../../unit/reducerType';\r\nimport { lastRecord } from '../../unit/const';\r\n\r\nlet initState = lastRecord && !isNaN(parseInt(lastRecord.startLines, 10)) ?\r\n  parseInt(lastRecord.startLines, 10) : 0;\r\nif (initState < 0 || initState > 10) {\r\n  initState = 0;\r\n}\r\n\r\nconst startLines = (state = initState, action) => {\r\n  switch (action.type) {\r\n    case reducerType.START_LINES:\r\n      return action.data;\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default startLines;\r\n","import * as reducerType from '../../unit/reducerType';\r\nimport { lastRecord, maxPoint } from '../../unit/const';\r\n\r\nlet initState = lastRecord && !isNaN(parseInt(lastRecord.max, 10)) ?\r\n  parseInt(lastRecord.max, 10) : 0;\r\n\r\nif (initState < 0) {\r\n  initState = 0;\r\n} else if (initState > maxPoint) {\r\n  initState = maxPoint;\r\n}\r\n\r\nconst parse = (state = initState, action) => {\r\n  switch (action.type) {\r\n    case reducerType.MAX:\r\n      return action.data > 999999 ? 999999 : action.data; // 最大分数\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default parse;\r\n","import * as reducerType from '../../unit/reducerType';\r\nimport { lastRecord, maxPoint } from '../../unit/const';\r\n\r\nlet initState = lastRecord && !isNaN(parseInt(lastRecord.points, 10)) ?\r\n  parseInt(lastRecord.points, 10) : 0;\r\n\r\nif (initState < 0) {\r\n  initState = 0;\r\n} else if (initState > maxPoint) {\r\n  initState = maxPoint;\r\n}\r\n\r\nconst points = (state = initState, action) => {\r\n  switch (action.type) {\r\n    case reducerType.POINTS:\r\n      return action.data > maxPoint ? maxPoint : action.data;\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default points;\r\n","import * as reducerType from '../../unit/reducerType';\r\nimport { lastRecord } from '../../unit/const';\r\n\r\nlet initState = lastRecord && !isNaN(parseInt(lastRecord.speedStart, 10)) ?\r\n  parseInt(lastRecord.speedStart, 10) : 1;\r\nif (initState < 1 || initState > 6) {\r\n  initState = 1;\r\n}\r\n\r\nconst speedStart = (state = initState, action) => {\r\n  switch (action.type) {\r\n    case reducerType.SPEED_START:\r\n      return action.data;\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default speedStart;\r\n","import * as reducerType from '../../unit/reducerType';\r\nimport { lastRecord } from '../../unit/const';\r\n\r\nlet initState = lastRecord && !isNaN(parseInt(lastRecord.speedRun, 10)) ?\r\n  parseInt(lastRecord.speedRun, 10) : 1;\r\nif (initState < 1 || initState > 6) {\r\n  initState = 1;\r\n}\r\n\r\nconst speedRun = (state = initState, action) => {\r\n  switch (action.type) {\r\n    case reducerType.SPEED_RUN:\r\n      return action.data;\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default speedRun;\r\n","import * as reducerType from '../../unit/reducerType';\r\nimport { lastRecord } from '../../unit/const';\r\n\r\nconst initState = lastRecord && lastRecord.lock !== undefined ? !!lastRecord.lock : false;\r\n\r\nconst lock = (state = initState, action) => {\r\n  switch (action.type) {\r\n    case reducerType.LOCK:\r\n      return action.data;\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default lock;\r\n","import * as reducerType from '../../unit/reducerType';\r\nimport { lastRecord } from '../../unit/const';\r\n\r\nlet initState = lastRecord && !isNaN(parseInt(lastRecord.clearLines, 10)) ?\r\n  parseInt(lastRecord.clearLines, 10) : 0;\r\nif (initState < 0) {\r\n  initState = 0;\r\n}\r\n\r\nconst clearLines = (state = initState, action) => {\r\n  switch (action.type) {\r\n    case reducerType.CLEAR_LINES:\r\n      return action.data;\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default clearLines;\r\n","import * as reducerType from '../../unit/reducerType';\r\nimport { lastRecord } from '../../unit/const';\r\n\r\nconst initState = lastRecord && lastRecord.reset ? !!lastRecord.reset : false;\r\nconst reset = (state = initState, action) => {\r\n  switch (action.type) {\r\n    case reducerType.RESET:\r\n      return action.data;\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default reset;\r\n","import * as reducerType from '../../unit/reducerType';\r\nimport { lastRecord } from '../../unit/const';\r\n\r\nconst initState = lastRecord && lastRecord.drop !== undefined ? !!lastRecord.drop : false;\r\n\r\nconst drop = (state = initState, action) => {\r\n  switch (action.type) {\r\n    case reducerType.DROP:\r\n      return action.data;\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default drop;\r\n","import * as reducerType from '../../unit/reducerType';\r\n\r\nconst initState = false;\r\n\r\nconst reducer = (state = initState, action) => {\r\n  switch (action.type) {\r\n    case reducerType.KEY_DROP:\r\n      return action.data;\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default reducer;\r\n","import * as reducerType from '../../unit/reducerType';\r\n\r\nconst initState = false;\r\n\r\nconst reducer = (state = initState, action) => {\r\n  switch (action.type) {\r\n    case reducerType.KEY_DOWN:\r\n      return action.data;\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default reducer;\r\n","import * as reducerType from '../../unit/reducerType';\r\n\r\nconst initState = false;\r\n\r\nconst reducer = (state = initState, action) => {\r\n  switch (action.type) {\r\n    case reducerType.KEY_LEFT:\r\n      return action.data;\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default reducer;\r\n","import * as reducerType from '../../unit/reducerType';\r\n\r\nconst initState = false;\r\n\r\nconst reducer = (state = initState, action) => {\r\n  switch (action.type) {\r\n    case reducerType.KEY_RIGHT:\r\n      return action.data;\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default reducer;\r\n","import * as reducerType from '../../unit/reducerType';\r\n\r\nconst initState = false;\r\n\r\nconst reducer = (state = initState, action) => {\r\n  switch (action.type) {\r\n    case reducerType.KEY_ROTATE:\r\n      return action.data;\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default reducer;\r\n","import * as reducerType from '../../unit/reducerType';\r\n\r\nconst initState = false;\r\n\r\nconst reducer = (state = initState, action) => {\r\n  switch (action.type) {\r\n    case reducerType.KEY_RESET:\r\n      return action.data;\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default reducer;\r\n","import * as reducerType from '../../unit/reducerType';\r\n\r\nconst initState = false;\r\n\r\nconst reducer = (state = initState, action) => {\r\n  switch (action.type) {\r\n    case reducerType.KEY_MUSIC:\r\n      return action.data;\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default reducer;\r\n","import * as reducerType from '../../unit/reducerType';\r\n\r\nconst initState = false;\r\n\r\nconst reducer = (state = initState, action) => {\r\n  switch (action.type) {\r\n    case reducerType.KEY_PAUSE:\r\n      return action.data;\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default reducer;\r\n","import { combineReducers } from 'redux-immutable';\r\nimport drop from './drop';\r\nimport down from './down';\r\nimport left from './left';\r\nimport right from './right';\r\nimport rotate from './rotate';\r\nimport reset from './reset';\r\nimport music from './music';\r\nimport pause from './pause';\r\n\r\nconst keyboardReducer = combineReducers({\r\n  drop,\r\n  down,\r\n  left,\r\n  right,\r\n  rotate,\r\n  reset,\r\n  music,\r\n  pause,\r\n});\r\n\r\nexport default keyboardReducer;\r\n","import * as reducerType from '../../unit/reducerType';\r\nimport { isFocus } from '../../unit/';\r\n\r\nconst initState = isFocus();\r\nconst focus = (state = initState, action) => {\r\n  switch (action.type) {\r\n    case reducerType.FOCUS:\r\n      return action.data;\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default focus;\r\n","import { combineReducers } from 'redux-immutable';\r\nimport pause from './pause';\r\nimport music from './music';\r\nimport matrix from './matrix';\r\nimport next from './next';\r\nimport cur from './cur';\r\nimport startLines from './startLines';\r\nimport max from './max';\r\nimport points from './points';\r\nimport speedStart from './speedStart';\r\nimport speedRun from './speedRun';\r\nimport lock from './lock';\r\nimport clearLines from './clearLines';\r\nimport reset from './reset';\r\nimport drop from './drop';\r\nimport keyboard from './keyboard';\r\nimport focus from './focus';\r\n\r\n\r\nconst rootReducer = combineReducers({\r\n  pause,\r\n  music,\r\n  matrix,\r\n  next,\r\n  cur,\r\n  startLines,\r\n  max,\r\n  points,\r\n  speedStart,\r\n  speedRun,\r\n  lock,\r\n  clearLines,\r\n  reset,\r\n  drop,\r\n  keyboard,\r\n  focus,\r\n});\r\n\r\nexport default rootReducer;\r\n","import { createStore } from 'redux';\r\nimport rootReducer from '../reducers';\r\n\r\nconst store = createStore(rootReducer, window.devToolsExtension && window.devToolsExtension());\r\n\r\nexport default store;\r\n","import { getNextType } from '../unit';\r\nimport * as reducerType from '../unit/reducerType';\r\nimport Block from '../unit/block';\r\nimport keyboard from './keyboard';\r\n\r\nfunction nextBlock(next = getNextType()) {\r\n  return {\r\n    type: reducerType.NEXT_BLOCK,\r\n    data: next,\r\n  };\r\n}\r\n\r\nfunction moveBlock(option) {\r\n  return {\r\n    type: reducerType.MOVE_BLOCK,\r\n    data: option.reset === true ? null : new Block(option),\r\n  };\r\n}\r\n\r\nfunction speedStart(n) {\r\n  return {\r\n    type: reducerType.SPEED_START,\r\n    data: n,\r\n  };\r\n}\r\n\r\nfunction speedRun(n) {\r\n  return {\r\n    type: reducerType.SPEED_RUN,\r\n    data: n,\r\n  };\r\n}\r\n\r\nfunction startLines(n) {\r\n  return {\r\n    type: reducerType.START_LINES,\r\n    data: n,\r\n  };\r\n}\r\n\r\nfunction matrix(data) {\r\n  return {\r\n    type: reducerType.MATRIX,\r\n    data,\r\n  };\r\n}\r\n\r\nfunction lock(data) {\r\n  return {\r\n    type: reducerType.LOCK,\r\n    data,\r\n  };\r\n}\r\n\r\nfunction clearLines(data) {\r\n  return {\r\n    type: reducerType.CLEAR_LINES,\r\n    data,\r\n  };\r\n}\r\n\r\nfunction points(data) {\r\n  return {\r\n    type: reducerType.POINTS,\r\n    data,\r\n  };\r\n}\r\n\r\nfunction max(data) {\r\n  return {\r\n    type: reducerType.MAX,\r\n    data,\r\n  };\r\n}\r\n\r\nfunction reset(data) {\r\n  return {\r\n    type: reducerType.RESET,\r\n    data,\r\n  };\r\n}\r\n\r\nfunction drop(data) {\r\n  return {\r\n    type: reducerType.DROP,\r\n    data,\r\n  };\r\n}\r\n\r\nfunction pause(data) {\r\n  return {\r\n    type: reducerType.PAUSE,\r\n    data,\r\n  };\r\n}\r\n\r\nfunction music(data) {\r\n  return {\r\n    type: reducerType.MUSIC,\r\n    data,\r\n  };\r\n}\r\n\r\nfunction focus(data) {\r\n  return {\r\n    type: reducerType.FOCUS,\r\n    data,\r\n  };\r\n}\r\n\r\nexport default {\r\n  nextBlock,\r\n  moveBlock,\r\n  speedStart,\r\n  speedRun,\r\n  startLines,\r\n  matrix,\r\n  lock,\r\n  clearLines,\r\n  points,\r\n  reset,\r\n  max,\r\n  drop,\r\n  pause,\r\n  keyboard,\r\n  music,\r\n  focus,\r\n};\r\n","import * as reducerType from '../unit/reducerType';\r\n\r\nfunction drop(data) {\r\n  return {\r\n    type: reducerType.KEY_DROP,\r\n    data,\r\n  };\r\n}\r\n\r\nfunction down(data) {\r\n  return {\r\n    type: reducerType.KEY_DOWN,\r\n    data,\r\n  };\r\n}\r\n\r\nfunction left(data) {\r\n  return {\r\n    type: reducerType.KEY_LEFT,\r\n    data,\r\n  };\r\n}\r\n\r\nfunction right(data) {\r\n  return {\r\n    type: reducerType.KEY_RIGHT,\r\n    data,\r\n  };\r\n}\r\n\r\nfunction rotate(data) {\r\n  return {\r\n    type: reducerType.KEY_ROTATE,\r\n    data,\r\n  };\r\n}\r\n\r\nfunction reset(data) {\r\n  return {\r\n    type: reducerType.KEY_RESET,\r\n    data,\r\n  };\r\n}\r\n\r\nfunction music(data) {\r\n  return {\r\n    type: reducerType.KEY_MUSIC,\r\n    data,\r\n  };\r\n}\r\n\r\nfunction pause(data) {\r\n  return {\r\n    type: reducerType.KEY_PAUSE,\r\n    data,\r\n  };\r\n}\r\n\r\nexport default {\r\n  drop,\r\n  down,\r\n  left,\r\n  right,\r\n  rotate,\r\n  reset,\r\n  music,\r\n  pause,\r\n};\r\n","import { List } from 'immutable';\r\nimport store from '../store';\r\nimport { want, isClear, isOver } from '../unit/';\r\nimport actions from '../actions';\r\nimport { speeds, blankLine, blankMatrix, clearPoints, eachLines } from '../unit/const';\r\nimport { music } from '../unit/music';\r\n\r\n\r\nconst getStartMatrix = (startLines) => {\r\n  const getLine = (min, max) => {\r\n    const count = parseInt((((max - min) + 1) * Math.random()) + min, 10);\r\n    const line = [];\r\n    for (let i = 0; i < count; i++) {\r\n      line.push(1);\r\n    }\r\n    for (let i = 0, len = 10 - count; i < len; i++) {\r\n      const index = parseInt(((line.length + 1) * Math.random()), 10);\r\n      line.splice(index, 0, 0);\r\n    }\r\n\r\n    return List(line);\r\n  };\r\n  let startMatrix = List([]);\r\n\r\n  for (let i = 0; i < startLines; i++) {\r\n    if (i <= 2) { // 0-3\r\n      startMatrix = startMatrix.push(getLine(5, 8));\r\n    } else if (i <= 6) { // 4-6\r\n      startMatrix = startMatrix.push(getLine(4, 9));\r\n    } else { // 7-9\r\n      startMatrix = startMatrix.push(getLine(3, 9));\r\n    }\r\n  }\r\n  for (let i = 0, len = 20 - startLines; i < len; i++) {\r\n    startMatrix = startMatrix.unshift(List(blankLine));\r\n  }\r\n  return startMatrix;\r\n};\r\n\r\nconst states = {\r\n  fallInterval: null,\r\n\r\n  start: () => {\r\n    if (music.start) {\r\n      music.start();\r\n    }\r\n    const state = store.getState();\r\n    states.dispatchPoints(0);\r\n    store.dispatch(actions.speedRun(state.get('speedStart')));\r\n    const startLines = state.get('startLines');\r\n    const startMatrix = getStartMatrix(startLines);\r\n    store.dispatch(actions.matrix(startMatrix));\r\n    store.dispatch(actions.moveBlock({ type: state.get('next') }));\r\n    store.dispatch(actions.nextBlock());\r\n    states.auto();\r\n  },\r\n\r\n  auto: (timeout) => {\r\n    const out = (timeout < 0 ? 0 : timeout);\r\n    let state = store.getState();\r\n    let cur = state.get('cur');\r\n    const fall = () => {\r\n      state = store.getState();\r\n      cur = state.get('cur');\r\n      const next = cur.fall();\r\n      if (want(next, state.get('matrix'))) {\r\n        store.dispatch(actions.moveBlock(next));\r\n        states.fallInterval = setTimeout(fall, speeds[state.get('speedRun') - 1]);\r\n      } else {\r\n        let matrix = state.get('matrix');\r\n        const shape = cur && cur.shape;\r\n        const xy = cur && cur.xy;\r\n        shape.forEach((m, k1) => (\r\n          m.forEach((n, k2) => {\r\n            if (n && xy.get(0) + k1 >= 0) {\r\n              let line = matrix.get(xy.get(0) + k1);\r\n              line = line.set(xy.get(1) + k2, 1);\r\n              matrix = matrix.set(xy.get(0) + k1, line);\r\n            }\r\n          })\r\n        ));\r\n        states.nextAround(matrix);\r\n      }\r\n    };\r\n    clearTimeout(states.fallInterval);\r\n    states.fallInterval = setTimeout(fall,\r\n      out === undefined ? speeds[state.get('speedRun') - 1] : out);\r\n  },\r\n\r\n  nextAround: (matrix, stopDownTrigger) => {\r\n    clearTimeout(states.fallInterval);\r\n    store.dispatch(actions.lock(true));\r\n    store.dispatch(actions.matrix(matrix));\r\n    if (typeof stopDownTrigger === 'function') {\r\n      stopDownTrigger();\r\n    }\r\n\r\n    const addPoints = (store.getState().get('points') + 10) +\r\n      ((store.getState().get('speedRun') - 1) * 2);\r\n\r\n    states.dispatchPoints(addPoints);\r\n\r\n    if (isClear(matrix)) {\r\n      if (music.clear) {\r\n        music.clear();\r\n      }\r\n      return;\r\n    }\r\n    if (isOver(matrix)) {\r\n      if (music.gameover) {\r\n        music.gameover();\r\n      }\r\n      states.overStart();\r\n      return;\r\n    }\r\n    setTimeout(() => {\r\n      store.dispatch(actions.lock(false));\r\n      store.dispatch(actions.moveBlock({ type: store.getState().get('next') }));\r\n      store.dispatch(actions.nextBlock());\r\n      states.auto();\r\n    }, 100);\r\n  },\r\n\r\n  focus: (isFocus) => {\r\n    store.dispatch(actions.focus(isFocus));\r\n    if (!isFocus) {\r\n      clearTimeout(states.fallInterval);\r\n      return;\r\n    }\r\n    const state = store.getState();\r\n    if (state.get('cur') && !state.get('reset') && !state.get('pause')) {\r\n      states.auto();\r\n    }\r\n  },\r\n\r\n  pause: (isPause) => {\r\n    store.dispatch(actions.pause(isPause));\r\n    if (isPause) {\r\n      clearTimeout(states.fallInterval);\r\n      return;\r\n    }\r\n    states.auto();\r\n  },\r\n\r\n  clearLines: (matrix, lines) => {\r\n    const state = store.getState();\r\n    let newMatrix = matrix;\r\n    lines.forEach(n => {\r\n      newMatrix = newMatrix.splice(n, 1);\r\n      newMatrix = newMatrix.unshift(List(blankLine));\r\n    });\r\n    store.dispatch(actions.matrix(newMatrix));\r\n    store.dispatch(actions.moveBlock({ type: state.get('next') }));\r\n    store.dispatch(actions.nextBlock());\r\n    states.auto();\r\n    store.dispatch(actions.lock(false));\r\n    const clearLines = state.get('clearLines') + lines.length;\r\n    store.dispatch(actions.clearLines(clearLines));\r\n\r\n    const addPoints = store.getState().get('points') +\r\n      clearPoints[lines.length - 1];\r\n    states.dispatchPoints(addPoints);\r\n\r\n    const speedAdd = Math.floor(clearLines / eachLines);\r\n    let speedNow = state.get('speedStart') + speedAdd;\r\n    speedNow = speedNow > 6 ? 6 : speedNow;\r\n    store.dispatch(actions.speedRun(speedNow));\r\n  },\r\n\r\n  overStart: () => {\r\n    clearTimeout(states.fallInterval);\r\n    store.dispatch(actions.lock(true));\r\n    store.dispatch(actions.reset(true));\r\n    store.dispatch(actions.pause(false));\r\n  },\r\n\r\n  overEnd: () => {\r\n    store.dispatch(actions.matrix(blankMatrix));\r\n    store.dispatch(actions.moveBlock({ reset: true }));\r\n    store.dispatch(actions.reset(false));\r\n    store.dispatch(actions.lock(false));\r\n    store.dispatch(actions.clearLines(0));\r\n  },\r\n\r\n  dispatchPoints: (point) => {\r\n    store.dispatch(actions.points(point));\r\n    if (point > 0 && point > store.getState().get('max')) {\r\n      store.dispatch(actions.max(point));\r\n    }\r\n  },\r\n};\r\n\r\nexport default states;\r\n","import React from 'react';\r\nimport immutable, { List } from 'immutable';\r\nimport classnames from 'classnames';\r\nimport propTypes from 'prop-types';\r\n\r\nimport './index.css';\r\nimport { isClear } from '../../unit/';\r\nimport { fillLine, blankLine } from '../../unit/const';\r\nimport states from '../../control/states';\r\n\r\nconst t = setTimeout;\r\n\r\nexport default class Matrix extends React.Component {\r\n  state = {\r\n    clearLines: false,\r\n    animateColor: 2,\r\n    isOver: false,\r\n    overState: null,\r\n  };\r\n\r\n  componentWillReceiveProps(nextProps = {}) {\r\n    const clears = isClear(nextProps.matrix);\r\n    const overs = nextProps.reset;\r\n    this.setState({\r\n      clearLines: clears,\r\n      isOver: overs,\r\n    });\r\n    if (clears && !this.state.clearLines) {\r\n      this.clearAnimate(clears);\r\n    }\r\n    if (!clears && overs && !this.state.isOver) {\r\n      this.over(nextProps);\r\n    }\r\n  }\r\n\r\n  shouldComponentUpdate(nextProps = {}) { // 使用Immutable 比较两个List 是否相等\r\n    const props = this.props;\r\n    return !(\r\n            immutable.is(nextProps.matrix, props.matrix) &&\r\n            immutable.is(\r\n                (nextProps.cur && nextProps.cur.shape),\r\n                (props.cur && props.cur.shape)\r\n            ) &&\r\n            immutable.is(\r\n                (nextProps.cur && nextProps.cur.xy),\r\n                (props.cur && props.cur.xy)\r\n            )\r\n        ) || this.state.clearLines\r\n        || this.state.isOver;\r\n  }\r\n\r\n  getResult(props = this.props) {\r\n    const cur = props.cur;\r\n    const shape = cur && cur.shape;\r\n    const xy = cur && cur.xy;\r\n\r\n    let matrix = props.matrix;\r\n    const clearLines = this.state.clearLines;\r\n    if (clearLines) {\r\n      const animateColor = this.state.animateColor;\r\n      clearLines.forEach((index) => {\r\n        matrix = matrix.set(index, List([\r\n          animateColor,\r\n          animateColor,\r\n          animateColor,\r\n          animateColor,\r\n          animateColor,\r\n          animateColor,\r\n          animateColor,\r\n          animateColor,\r\n          animateColor,\r\n          animateColor,\r\n        ]));\r\n      });\r\n    } else if (shape) {\r\n      shape.forEach((m, k1) => (\r\n          m.forEach((n, k2) => {\r\n            if (n && xy.get(0) + k1 >= 0) { // 竖坐标可以为负\r\n              let line = matrix.get(xy.get(0) + k1);\r\n              let color;\r\n              if (line.get(xy.get(1) + k2) === 1 && !clearLines) { // 矩阵与方块重合\r\n                color = 2;\r\n              } else {\r\n                color = 1;\r\n              }\r\n              line = line.set(xy.get(1) + k2, color);\r\n              matrix = matrix.set(xy.get(0) + k1, line);\r\n            }\r\n          })\r\n      ));\r\n    }\r\n    return matrix;\r\n  }\r\n\r\n  clearAnimate() {\r\n    const anima = (callback) => {\r\n      t(() => {\r\n        this.setState({\r\n          animateColor: 0,\r\n        });\r\n        t(() => {\r\n          this.setState({\r\n            animateColor: 2,\r\n          });\r\n          if (typeof callback === 'function') {\r\n            callback();\r\n          }\r\n        }, 100);\r\n      }, 100);\r\n    };\r\n    anima(() => {\r\n      anima(() => {\r\n        anima(() => {\r\n          t(() => {\r\n            states.clearLines(this.props.matrix, this.state.clearLines);\r\n          }, 100);\r\n        });\r\n      });\r\n    });\r\n  }\r\n\r\n  over(nextProps) {\r\n    let overState = this.getResult(nextProps);\r\n    this.setState({\r\n      overState,\r\n    });\r\n\r\n    const exLine = (index) => {\r\n      if (index <= 19) {\r\n        overState = overState.set(19 - index, List(fillLine));\r\n      } else if (index >= 20 && index <= 39) {\r\n        overState = overState.set(index - 20, List(blankLine));\r\n      } else {\r\n        states.overEnd();\r\n        return;\r\n      }\r\n      this.setState({\r\n        overState,\r\n      });\r\n    };\r\n\r\n    for (let i = 0; i <= 40; i++) {\r\n      t(exLine.bind(null, i), 40 * (i + 1));\r\n    }\r\n  }\r\n\r\n  render() {\r\n    let matrix;\r\n    if (this.state.isOver) {\r\n      matrix = this.state.overState;\r\n    } else {\r\n      matrix = this.getResult();\r\n    }\r\n    return (\r\n        <div className=\"matrix\">{\r\n          matrix.map((p, k1) => (<p key={k1}>\r\n            {\r\n              p.map((e, k2) => <b\r\n                  className={classnames({\r\n                    c: e === 1,\r\n                    d: e === 2,\r\n                  })}\r\n                  key={k2}\r\n              />)\r\n            }\r\n          </p>))\r\n        }\r\n        </div>\r\n    );\r\n  }\r\n}\r\n\r\nMatrix.propTypes = {\r\n  matrix: propTypes.object.isRequired,\r\n  cur: propTypes.object,\r\n  reset: propTypes.bool.isRequired,\r\n};\r\n","import React from 'react';\r\nimport cn from 'classnames';\r\nimport './index.css';\r\n\r\nconst Decorate = () => {\r\n  return (\r\n      <div className=\"decorate\">\r\n        <div className=\"topBorder\">\r\n          <span className={cn(['l', \"mr\"])} style={{ width: 40 }} />\r\n          <span className={cn(['l', \"mr\"])} />\r\n          <span className={cn(['l', \"mr\"])} />\r\n          <span className={cn(['l', \"mr\"])} />\r\n          <span className={cn(['l', \"mr\"])} />\r\n          <span className={cn(['r', \"ml\"])} style={{ width: 40 }} />\r\n          <span className={cn(['r', \"ml\"])} />\r\n          <span className={cn(['r', \"ml\"])} />\r\n          <span className={cn(['r', \"ml\"])} />\r\n          <span className={cn(['r', \"ml\"])} />\r\n        </div>\r\n        <h1>T E T R I S</h1>\r\n        <div className=\"view\">\r\n          <b className=\"c\" />\r\n          <div className=\"clear\" />\r\n          <b className=\"c\" />\r\n          <b className=\"c\" />\r\n          <div className=\"clear\" />\r\n          <em />\r\n          <b className=\"c\" />\r\n          <p />\r\n          <em />\r\n          <b className=\"c\" />\r\n          <div className=\"clear\" />\r\n          <b className=\"c\" />\r\n          <b className=\"c\" />\r\n          <div className=\"clear\" />\r\n          <em />\r\n          <b className=\"c\" />\r\n          <p />\r\n          <b className=\"c\" />\r\n          <b className=\"c\" />\r\n          <b className=\"c\" />\r\n          <b className=\"c\" />\r\n          <p />\r\n          <b className=\"c\" />\r\n          <div className=\"clear\" />\r\n          <b className=\"c\" />\r\n          <b className=\"c\" />\r\n          <div className=\"clear\" />\r\n          <b className=\"c\" />\r\n          <p />\r\n          <b className=\"c\" />\r\n          <b className=\"c\" />\r\n          <div className=\"clear\" />\r\n          <b className=\"c\" />\r\n          <div className=\"clear\" />\r\n          <b className=\"c\" />\r\n          <p />\r\n          <em />\r\n          <b className=\"c\" />\r\n          <div className=\"clear\" />\r\n          <em />\r\n          <b className=\"c\" />\r\n          <div className=\"clear\" />\r\n          <em />\r\n          <b className=\"c\" />\r\n          <div className=\"clear\" />\r\n          <em />\r\n          <b className=\"c\" />\r\n        </div>\r\n        <div className={cn([\"view\", \"l\"])}>\r\n          <em />\r\n          <b className=\"c\" />\r\n          <div className=\"clear\" />\r\n          <b className=\"c\" />\r\n          <b className=\"c\" />\r\n          <div className=\"clear\" />\r\n          <b className=\"c\" />\r\n          <p />\r\n          <b className=\"c\" />\r\n          <div className=\"clear\" />\r\n          <b className=\"c\" />\r\n          <b className=\"c\" />\r\n          <div className=\"clear\" />\r\n          <b className=\"c\" />\r\n          <p />\r\n          <b className=\"c\" />\r\n          <b className=\"c\" />\r\n          <b className=\"c\" />\r\n          <b className=\"c\" />\r\n          <p />\r\n          <em />\r\n          <b className=\"c\" />\r\n          <div className=\"clear\" />\r\n          <b className=\"c\" />\r\n          <b className=\"c\" />\r\n          <div className=\"clear\" />\r\n          <em />\r\n          <b className=\"c\" />\r\n          <p />\r\n          <b className=\"c\" />\r\n          <b className=\"c\" />\r\n          <div className=\"clear\" />\r\n          <em />\r\n          <b className=\"c\" />\r\n          <div className=\"clear\" />\r\n          <em />\r\n          <b className=\"c\" />\r\n          <p />\r\n          <b className=\"c\" />\r\n          <div className=\"clear\" />\r\n          <b className=\"c\" />\r\n          <div className=\"clear\" />\r\n          <b className=\"c\" />\r\n          <div className=\"clear\" />\r\n          <b className=\"c\" />\r\n        </div>\r\n      </div>\r\n  );\r\n};\r\n\r\nexport default Decorate;\r\n","import React from 'react';\r\nimport cn from 'classnames';\r\nimport propTypes from 'prop-types';\r\nimport './index.css';\r\n\r\nconst render = (data) => (\r\n    <div className=\"number\">\r\n      {\r\n        data.map((e, k) => (\r\n            <span className={cn(['bg', [`s_${e}`]])} key={k} />\r\n        ))\r\n      }\r\n    </div>\r\n);\r\n\r\nconst formate = (num) => (\r\n    num < 10 ? `0${num}`.split('') : `${num}`.split('')\r\n);\r\n\r\nexport default class Number extends React.Component {\r\n  constructor() {\r\n    super();\r\n    this.state = {\r\n      time_count: false,\r\n      time: new Date(),\r\n    };\r\n  }\r\n\r\n  componentWillMount() {\r\n    if (!this.props.time) {\r\n      return;\r\n    }\r\n\r\n    const clock = () => {\r\n      const count = +Number.timeInterval;\r\n      Number.timeInterval = setTimeout(() => {\r\n        this.setState({\r\n          time: new Date(),\r\n          time_count: count,\r\n        });\r\n        clock();\r\n      }, 1000);\r\n    };\r\n    clock();\r\n  }\r\n\r\n  shouldComponentUpdate({ number }) {\r\n    if (this.props.time) {\r\n      if (this.state.time_count !== Number.time_count) {\r\n        if (this.state.time_count !== false) {\r\n          Number.time_count = this.state.time_count;\r\n        }\r\n\r\n        return true;\r\n      }\r\n\r\n      return false;\r\n    }\r\n\r\n    return this.props.number !== number;\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    if (!this.props.time) {\r\n      return;\r\n    }\r\n\r\n    clearTimeout(Number.timeInterval);\r\n  }\r\n\r\n  render() {\r\n    if (this.props.time) {\r\n      const now = this.state.time;\r\n      const hour = formate(now.getHours());\r\n      const min = formate(now.getMinutes());\r\n      const sec = now.getSeconds() % 2;\r\n      const t = hour.concat(sec ? 'd' : 'd_c', min);\r\n\r\n      return (render(t));\r\n    }\r\n\r\n    const num = `${this.props.number}`.split('');\r\n\r\n    for (let i = 0, len = this.props.length - num.length; i < len; i++) {\r\n      num.unshift('n');\r\n    }\r\n\r\n    return (render(num));\r\n  }\r\n}\r\n\r\nNumber.statics = {\r\n  timeInterval: null,\r\n  time_count: null,\r\n};\r\n\r\nNumber.propTypes = {\r\n  number: propTypes.number,\r\n  length: propTypes.number,\r\n  time: propTypes.bool,\r\n};\r\n\r\nNumber.defaultProps = {\r\n  length: 6,\r\n};\r\n","import React from 'react';\r\nimport propTypes from 'prop-types';\r\n\r\nimport './index.css';\r\nimport { blockShape } from '../../unit/const';\r\n\r\nconst xy = { // 方块在下一个中的坐标\r\n  I: [1, 0],\r\n  L: [0, 0],\r\n  J: [0, 0],\r\n  Z: [0, 0],\r\n  S: [0, 0],\r\n  O: [0, 1],\r\n  T: [0, 0],\r\n};\r\n\r\nconst empty = [\r\n  [0, 0, 0, 0],\r\n  [0, 0, 0, 0],\r\n];\r\n\r\nexport default class Next extends React.Component {\r\n  state = {\r\n      block: empty,\r\n  };\r\n\r\n  componentWillMount() {\r\n      this.build(this.props.data);\r\n  }\r\n\r\n  componentWillReceiveProps(nextProps) {\r\n      this.build(nextProps.data);\r\n  }\r\n\r\n  shouldComponentUpdate(nextProps) {\r\n      return nextProps.data !== this.props.data;\r\n  }\r\n\r\n  build(type) {\r\n    const shape = blockShape[type];\r\n    const block = empty.map(e => ([...e]));\r\n\r\n    shape.forEach((m, k1) => {\r\n        m.forEach((n, k2) => {\r\n          if (n) {\r\n            block[k1 + xy[type][0]][k2 + xy[type][1]] = 1;\r\n          }\r\n        });\r\n    });\r\n\r\n    this.setState({ block });\r\n  }\r\n\r\n  render() {\r\n    return (\r\n        <div className=\"next\">\r\n          {\r\n            this.state.block.map((arr, k1) => (\r\n                <div key={k1}>\r\n                  {\r\n                    arr.map((e, k2) => (\r\n                        <b className={e ? 'c' : ''} key={k2} />\r\n                    ))\r\n                  }\r\n                </div>\r\n            ))\r\n          }\r\n        </div>\r\n    );\r\n  }\r\n}\r\n\r\nNext.propTypes = {\r\n    data: propTypes.string,\r\n};\r\n","import React from 'react';\r\nimport cn from 'classnames';\r\nimport propTypes from 'prop-types';\r\nimport './index.css';\r\n\r\nexport default class Music extends React.Component {\r\n    shouldComponentUpdate({ data }) {\r\n        return data !== this.props.data;\r\n    }\r\n    render() {\r\n        return (\r\n            <div\r\n                className={cn(\r\n                    {\r\n                        bg: true,\r\n                        \"music\": true,\r\n                        \"c\": !this.props.data,\r\n                    }\r\n                )}\r\n            />\r\n        );\r\n    }\r\n}\r\n\r\nMusic.propTypes = {\r\n    data: propTypes.bool.isRequired,\r\n};\r\n","import React from 'react';\r\nimport cn from 'classnames';\r\nimport propTypes from 'prop-types';\r\nimport './index.css';\r\n\r\nexport default class Pause extends React.Component {\r\n  state = {\r\n    showPause: false,\r\n  };\r\n\r\n  componentDidMount() {\r\n      this.setShake(this.props.data);\r\n  }\r\n\r\n  componentWillReceiveProps({ data }) {\r\n      this.setShake(data);\r\n  }\r\n\r\n  shouldComponentUpdate({ data }) {\r\n      if (data) {\r\n          return true;\r\n      }\r\n\r\n      return data !== this.props.data;\r\n  }\r\n\r\n  setShake(bool) {\r\n      if (bool && !Pause.timeout) {\r\n          Pause.timeout = setInterval(() => {\r\n              this.setState({\r\n                showPause: !this.state.showPause,});\r\n              }, 250);\r\n      }\r\n\r\n      if (!bool && Pause.timeout) {\r\n      clearInterval(Pause.timeout);\r\n      this.setState({\r\n        showPause: false,\r\n      });\r\n      Pause.timeout = null;\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div\r\n        className={cn(\r\n          {\r\n            bg: true,\r\n            \"pause\": true,\r\n            \"c\": this.state.showPause,\r\n          }\r\n        )}\r\n      />\r\n    );\r\n  }\r\n}\r\n\r\nPause.statics = {\r\n  timeout: null,\r\n};\r\n\r\nPause.propTypes = {\r\n  data: propTypes.bool.isRequired,\r\n};\r\n\r\nPause.defaultProps = {\r\n  data: false,\r\n};\r\n","import React from 'react';\r\nimport propTypes from 'prop-types';\r\nimport Number from '../number';\r\n\r\nconst DF = 'Point';\r\nconst ZDF = 'Max';\r\nconst SLDF = 'Last Round';\r\n\r\nexport default class Point extends React.Component {\r\n  constructor() {\r\n    super();\r\n    this.state = {\r\n      label: '',\r\n      number: 0,\r\n    };\r\n  }\r\n\r\n  componentWillMount() {\r\n    this.onChange(this.props);\r\n  }\r\n\r\n  componentWillReceiveProps(nextProps) {\r\n    this.onChange(nextProps);\r\n  }\r\n\r\n  shouldComponentUpdate({ cur, point, max }) {\r\n    const props = this.props;\r\n    return cur !== props.cur || point !== props.point || max !== props.max || !props.cur;\r\n  }\r\n\r\n  onChange({ cur, point, max }) {\r\n    clearInterval(Point.timeout);\r\n    if (cur) {\r\n      this.setState({\r\n        label: point >= max ? ZDF : DF,\r\n        number: point,\r\n      });\r\n    } else {\r\n      const toggle = () => {\r\n        this.setState({\r\n          label: SLDF,\r\n          number: point,\r\n        });\r\n        Point.timeout = setTimeout(() => {\r\n          this.setState({\r\n            label: ZDF,\r\n            number: max,\r\n          });\r\n          Point.timeout = setTimeout(toggle, 3000);\r\n        }, 3000);\r\n      };\r\n\r\n      if (point !== 0) {\r\n        toggle();\r\n      } else {\r\n        this.setState({\r\n          label: ZDF,\r\n          number: max,\r\n        });\r\n      }\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div>\r\n        <p>{ this.state.label }</p>\r\n        <Number number={this.state.number} />\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nPoint.statics = {\r\n  timeout: null,\r\n};\r\n\r\nPoint.propTypes = {\r\n  cur: propTypes.bool,\r\n  max: propTypes.number.isRequired,\r\n  point: propTypes.number.isRequired,\r\n};\r\n\r\n","import React from 'react';\r\nimport cn from 'classnames';\r\nimport propTypes from 'prop-types';\r\nimport './index.css';\r\n\r\nexport default class Logo extends React.Component {\r\n  state = {\r\n    style: \"r1\",\r\n    display: 'none',\r\n  };\r\n\r\n  componentWillMount() {\r\n    this.animate(this.props);\r\n  }\r\n\r\n  componentWillReceiveProps(nextProps) {\r\n    if (\r\n        (\r\n            [this.props.cur, nextProps.cur].indexOf(false) !== -1 &&\r\n            (this.props.cur !== nextProps.cur)\r\n        ) ||\r\n        (this.props.reset !== nextProps.reset)\r\n    ) {\r\n      this.animate(nextProps);\r\n    }\r\n  }\r\n\r\n  shouldComponentUpdate({ cur, reset }) {\r\n    return cur !== this.props.cur || reset !== this.props.reset || !cur;\r\n  }\r\n\r\n  animate({ cur, reset }) {\r\n    clearTimeout(Logo.timeout);\r\n    this.setState({\r\n      style: \"r1\",\r\n      display: 'none',\r\n    });\r\n    if (cur || reset) {\r\n      this.setState({ display: 'none' });\r\n      return;\r\n    }\r\n\r\n    let m = 'r';\r\n    let count = 0;\r\n\r\n    const set = (func, delay) => {\r\n      if (!func) {\r\n        return;\r\n      }\r\n      Logo.timeout = setTimeout(func, delay);\r\n    };\r\n\r\n    const show = (func) => {\r\n      set(() => {\r\n        this.setState({\r\n          display: 'block',\r\n        });\r\n        if (func) {\r\n          func();\r\n        }\r\n      }, 150);\r\n    };\r\n\r\n    const hide = (func) => {\r\n      set(() => {\r\n        this.setState({\r\n          display: 'none',\r\n        });\r\n        if (func) {\r\n          func();\r\n        }\r\n      }, 150);\r\n    };\r\n\r\n    const eyes = (func, delay1, delay2) => {\r\n      set(() => {\r\n        this.setState({ style: m + 2 });\r\n        set(() => {\r\n          this.setState({ style: m + 1 });\r\n          if (func) {\r\n            func();\r\n          }\r\n        }, delay2);\r\n      }, delay1);\r\n    };\r\n\r\n    const run = (func) => {\r\n      set(() => {\r\n        this.setState({ style: m + 4 });\r\n        set(() => {\r\n          this.setState({ style: m + 3 });\r\n          count++;\r\n          if (count === 10 || count === 20 || count === 30) {\r\n            m = m === 'r' ? 'l' : 'r';\r\n          }\r\n          if (count < 40) {\r\n            run(func);\r\n            return;\r\n          }\r\n          this.setState({ style: m + 1 });\r\n          if (func) {\r\n            set(func, 4000);\r\n          }\r\n        }, 100);\r\n      }, 100);\r\n    };\r\n\r\n    const dra = () => {\r\n      count = 0;\r\n      eyes(() => {\r\n        eyes(() => {\r\n          eyes(() => {\r\n            this.setState({ style: m + 2});\r\n            run(dra);\r\n          }, 150, 150);\r\n        }, 150, 150);\r\n      }, 1000, 1500);\r\n    };\r\n\r\n    show(() => {\r\n      hide(() => {\r\n        show(() => {\r\n          hide(() => {\r\n            show(() => {\r\n              dra();\r\n            });\r\n          });\r\n        });\r\n      });\r\n    });\r\n  }\r\n\r\n  render() {\r\n    if (this.props.cur) {\r\n      return null;\r\n    }\r\n    return (\r\n        <div className=\"logo\" style={{ display: this.state.display }}>\r\n          <div className={cn({ bg: true, 'dragon': true, [this.state.style]: true })} />\r\n        </div>\r\n    );\r\n  }\r\n}\r\n\r\nLogo.propTypes = {\r\n  cur: propTypes.bool,\r\n  reset: propTypes.bool.isRequired,\r\n};\r\n\r\nLogo.statics = {\r\n  timeout: null,\r\n};\r\n","import React from 'react';\r\nimport cn from 'classnames';\r\nimport propTypes from 'prop-types';\r\nimport { transform } from '../../../unit/const';\r\nimport './index.css';\r\n\r\nexport default class Button extends React.Component {\r\n  shouldComponentUpdate(nextProps) {\r\n    return nextProps.active !== this.props.active;\r\n  }\r\n\r\n  render() {\r\n    const {\r\n      active, color, size, top, left, label, position, arrow,\r\n    } = this.props;\r\n    return (\r\n        <div\r\n            className={cn({ \"button\": true, [color]: true, [size]: true })}\r\n            style={{ top, left }}\r\n        >\r\n          <i\r\n              className={cn({ \"active\": active })}\r\n              ref={(c) => { this.dom = c; }}\r\n          />\r\n          { size === 's1' && <em\r\n              style={{\r\n                [transform]: `${arrow} scale(1,2)`,\r\n              }}\r\n          /> }\r\n          <span className={cn({ \"position\": position })}>{label}</span>\r\n        </div>\r\n    );\r\n  }\r\n}\r\n\r\nButton.propTypes = {\r\n  color: propTypes.string.isRequired,\r\n  size: propTypes.string.isRequired,\r\n  top: propTypes.number.isRequired,\r\n  left: propTypes.number.isRequired,\r\n  label: propTypes.string.isRequired,\r\n  position: propTypes.bool,\r\n  arrow: propTypes.string,\r\n  active: propTypes.bool.isRequired,\r\n};\r\n\r\n","const eventName = {};\r\n\r\nconst down = (o) => {\r\n  const keys = Object.keys(eventName);\r\n  keys.forEach(i => {\r\n    clearTimeout(eventName[i]);\r\n    eventName[i] = null;\r\n  });\r\n  if (!o.callback) {\r\n    return;\r\n  }\r\n  const clear = () => {\r\n    clearTimeout(eventName[o.key]);\r\n  };\r\n  o.callback(clear);\r\n  if (o.once === true) {\r\n    return;\r\n  }\r\n  let begin = o.begin || 100;\r\n  const interval = o.interval || 50;\r\n  const loop = () => {\r\n    eventName[o.key] = setTimeout(() => {\r\n      begin = null;\r\n      loop();\r\n      o.callback(clear);\r\n    }, begin || interval);\r\n  };\r\n  loop();\r\n};\r\n\r\nconst up = (o) => {\r\n  clearTimeout(eventName[o.key]);\r\n  eventName[o.key] = null;\r\n  if (!o.callback) {\r\n    return;\r\n  }\r\n  o.callback();\r\n};\r\n\r\nconst clearAll = () => {\r\n  const keys = Object.keys(eventName);\r\n  keys.forEach(i => {\r\n    clearTimeout(eventName[i]);\r\n    eventName[i] = null;\r\n  });\r\n};\r\n\r\nexport default {\r\n  down,\r\n  up,\r\n  clearAll,\r\n};\r\n","import left from './left';\r\nimport right from './right';\r\nimport down from './down';\r\nimport rotate from './rotate';\r\nimport space from './space';\r\nimport s from './s';\r\nimport r from './r';\r\nimport p from './p';\r\n\r\nexport default {\r\n  left,\r\n  down,\r\n  rotate,\r\n  right,\r\n  space,\r\n  r,\r\n  p,\r\n  s,\r\n};\r\n","import { want } from '../../unit/';\r\nimport event from '../../unit/event';\r\nimport actions from '../../actions';\r\nimport states from '../states';\r\nimport { speeds, delays } from '../../unit/const';\r\nimport { music } from '../../unit/music';\r\n\r\nconst down = (store) => {\r\n  store.dispatch(actions.keyboard.left(true));\r\n  event.down({\r\n    key: 'left',\r\n    begin: 200,\r\n    interval: 100,\r\n    callback: () => {\r\n      const state = store.getState();\r\n      if (state.get('lock')) {\r\n        return;\r\n      }\r\n      if (music.move) {\r\n        music.move();\r\n      }\r\n      const cur = state.get('cur');\r\n      if (cur !== null) {\r\n        if (state.get('pause')) {\r\n          states.pause(false);\r\n          return;\r\n        }\r\n        const next = cur.left();\r\n        const delay = delays[state.get('speedRun') - 1];\r\n        let timeStamp;\r\n        if (want(next, state.get('matrix'))) {\r\n          next.timeStamp += parseInt(delay, 10);\r\n          store.dispatch(actions.moveBlock(next));\r\n          timeStamp = next.timeStamp;\r\n        } else {\r\n          cur.timeStamp += parseInt(parseInt(delay, 10) / 1.5, 10);\r\n          store.dispatch(actions.moveBlock(cur));\r\n          timeStamp = cur.timeStamp;\r\n        }\r\n        const remain = speeds[state.get('speedRun') - 1] - (Date.now() - timeStamp);\r\n        states.auto(remain);\r\n      } else {\r\n        let speed = state.get('speedStart');\r\n        speed = speed - 1 < 1 ? 6 : speed - 1;\r\n        store.dispatch(actions.speedStart(speed));\r\n      }\r\n    },\r\n  });\r\n};\r\n\r\nconst up = (store) => {\r\n  store.dispatch(actions.keyboard.left(false));\r\n  event.up({\r\n    key: 'left',\r\n  });\r\n};\r\n\r\nexport default {\r\n  down,\r\n  up,\r\n};\r\n","import { want } from '../../unit/';\r\nimport event from '../../unit/event';\r\nimport actions from '../../actions';\r\nimport states from '../states';\r\nimport { music } from '../../unit/music';\r\n\r\nconst down = (store) => {\r\n  store.dispatch(actions.keyboard.down(true));\r\n  if (store.getState().get('cur') !== null) {\r\n    event.down({\r\n      key: 'down',\r\n      begin: 40,\r\n      interval: 40,\r\n      callback: (stopDownTrigger) => {\r\n        const state = store.getState();\r\n        if (state.get('lock')) {\r\n          return;\r\n        }\r\n        if (music.move) {\r\n          music.move();\r\n        }\r\n        const cur = state.get('cur');\r\n        if (cur === null) {\r\n          return;\r\n        }\r\n        if (state.get('pause')) {\r\n          states.pause(false);\r\n          return;\r\n        }\r\n        const next = cur.fall();\r\n        if (want(next, state.get('matrix'))) {\r\n          store.dispatch(actions.moveBlock(next));\r\n          states.auto();\r\n        } else {\r\n          let matrix = state.get('matrix');\r\n          const shape = cur.shape;\r\n          const xy = cur.xy;\r\n          shape.forEach((m, k1) => (\r\n            m.forEach((n, k2) => {\r\n              if (n && xy.get(0) + k1 >= 0) {\r\n                let line = matrix.get(xy.get(0) + k1);\r\n                line = line.set(xy.get(1) + k2, 1);\r\n                matrix = matrix.set(xy.get(0) + k1, line);\r\n              }\r\n            })\r\n          ));\r\n          states.nextAround(matrix, stopDownTrigger);\r\n        }\r\n      },\r\n    });\r\n  } else {\r\n    event.down({\r\n      key: 'down',\r\n      begin: 200,\r\n      interval: 100,\r\n      callback: () => {\r\n        if (store.getState().get('lock')) {\r\n          return;\r\n        }\r\n        const state = store.getState();\r\n        const cur = state.get('cur');\r\n        if (cur) {\r\n          return;\r\n        }\r\n        if (music.move) {\r\n          music.move();\r\n        }\r\n        let startLines = state.get('startLines');\r\n        startLines = startLines - 1 < 0 ? 10 : startLines - 1;\r\n        store.dispatch(actions.startLines(startLines));\r\n      },\r\n    });\r\n  }\r\n};\r\n\r\nconst up = (store) => {\r\n  store.dispatch(actions.keyboard.down(false));\r\n  event.up({\r\n    key: 'down',\r\n  });\r\n};\r\n\r\n\r\nexport default {\r\n  down,\r\n  up,\r\n};\r\n","import { want } from '../../unit/';\r\nimport event from '../../unit/event';\r\nimport actions from '../../actions';\r\nimport states from '../states';\r\nimport { music } from '../../unit/music';\r\n\r\nconst down = (store) => {\r\n  store.dispatch(actions.keyboard.rotate(true));\r\n  if (store.getState().get('cur') !== null) {\r\n    event.down({\r\n      key: 'rotate',\r\n      once: true,\r\n      callback: () => {\r\n        const state = store.getState();\r\n        if (state.get('lock')) {\r\n          return;\r\n        }\r\n        if (state.get('pause')) {\r\n          states.pause(false);\r\n        }\r\n        const cur = state.get('cur');\r\n        if (cur === null) {\r\n          return;\r\n        }\r\n        if (music.rotate) {\r\n          music.rotate();\r\n        }\r\n        const next = cur.rotate();\r\n        if (want(next, state.get('matrix'))) {\r\n          store.dispatch(actions.moveBlock(next));\r\n        }\r\n      },\r\n    });\r\n  } else {\r\n    event.down({\r\n      key: 'rotate',\r\n      begin: 200,\r\n      interval: 100,\r\n      callback: () => {\r\n        if (store.getState().get('lock')) {\r\n          return;\r\n        }\r\n        if (music.move) {\r\n          music.move();\r\n        }\r\n        const state = store.getState();\r\n        const cur = state.get('cur');\r\n        if (cur) {\r\n          return;\r\n        }\r\n        let startLines = state.get('startLines');\r\n        startLines = startLines + 1 > 10 ? 0 : startLines + 1;\r\n        store.dispatch(actions.startLines(startLines));\r\n      },\r\n    });\r\n  }\r\n};\r\n\r\nconst up = (store) => {\r\n  store.dispatch(actions.keyboard.rotate(false));\r\n  event.up({\r\n    key: 'rotate',\r\n  });\r\n};\r\n\r\nexport default {\r\n  down,\r\n  up,\r\n};\r\n","import { want } from '../../unit/';\r\nimport event from '../../unit/event';\r\nimport actions from '../../actions';\r\nimport states from '../states';\r\nimport { speeds, delays } from '../../unit/const';\r\nimport { music } from '../../unit/music';\r\n\r\nconst down = (store) => {\r\n  store.dispatch(actions.keyboard.right(true));\r\n  event.down({\r\n    key: 'right',\r\n    begin: 200,\r\n    interval: 100,\r\n    callback: () => {\r\n      const state = store.getState();\r\n      if (state.get('lock')) {\r\n        return;\r\n      }\r\n      if (music.move) {\r\n        music.move();\r\n      }\r\n      const cur = state.get('cur');\r\n      if (cur !== null) {\r\n        if (state.get('pause')) {\r\n          states.pause(false);\r\n          return;\r\n        }\r\n        const next = cur.right();\r\n        const delay = delays[state.get('speedRun') - 1];\r\n        let timeStamp;\r\n        if (want(next, state.get('matrix'))) {\r\n          next.timeStamp += parseInt(delay, 10);\r\n          store.dispatch(actions.moveBlock(next));\r\n          timeStamp = next.timeStamp;\r\n        } else {\r\n          cur.timeStamp += parseInt(parseInt(delay, 10) / 1.5, 10);\r\n          store.dispatch(actions.moveBlock(cur));\r\n          timeStamp = cur.timeStamp;\r\n        }\r\n        const remain = speeds[state.get('speedRun') - 1] - (Date.now() - timeStamp);\r\n        states.auto(remain);\r\n      } else {\r\n        let speed = state.get('speedStart');\r\n        speed = speed + 1 > 6 ? 1 : speed + 1;\r\n        store.dispatch(actions.speedStart(speed));\r\n      }\r\n    },\r\n  });\r\n};\r\n\r\nconst up = (store) => {\r\n  store.dispatch(actions.keyboard.right(false));\r\n  event.up({\r\n    key: 'right',\r\n  });\r\n};\r\n\r\nexport default {\r\n  down,\r\n  up,\r\n};\r\n","import { want } from '../../unit/';\r\nimport event from '../../unit/event';\r\nimport actions from '../../actions';\r\nimport states from '../states';\r\nimport { music } from '../../unit/music';\r\n\r\nconst down = (store) => {\r\n  store.dispatch(actions.keyboard.drop(true));\r\n  event.down({\r\n    key: 'space',\r\n    once: true,\r\n    callback: () => {\r\n      const state = store.getState();\r\n      if (state.get('lock')) {\r\n        return;\r\n      }\r\n      const cur = state.get('cur');\r\n      if (cur !== null) {\r\n        if (state.get('pause')) {\r\n          states.pause(false);\r\n          return;\r\n        }\r\n        if (music.fall) {\r\n          music.fall();\r\n        }\r\n        let index = 0;\r\n        let bottom = cur.fall(index);\r\n        while (want(bottom, state.get('matrix'))) {\r\n          bottom = cur.fall(index);\r\n          index++;\r\n        }\r\n        let matrix = state.get('matrix');\r\n        bottom = cur.fall(index - 2);\r\n        store.dispatch(actions.moveBlock(bottom));\r\n        const shape = bottom.shape;\r\n        const xy = bottom.xy;\r\n        shape.forEach((m, k1) => (\r\n          m.forEach((n, k2) => {\r\n            if (n && xy[0] + k1 >= 0) {\r\n              let line = matrix.get(xy[0] + k1);\r\n              line = line.set(xy[1] + k2, 1);\r\n              matrix = matrix.set(xy[0] + k1, line);\r\n            }\r\n          })\r\n        ));\r\n        store.dispatch(actions.drop(true));\r\n        setTimeout(() => {\r\n          store.dispatch(actions.drop(false));\r\n        }, 100);\r\n        states.nextAround(matrix);\r\n      } else {\r\n        states.start();\r\n      }\r\n    },\r\n  });\r\n};\r\n\r\nconst up = (store) => {\r\n  store.dispatch(actions.keyboard.drop(false));\r\n  event.up({\r\n    key: 'space',\r\n  });\r\n};\r\n\r\nexport default {\r\n  down,\r\n  up,\r\n};\r\n","import event from '../../unit/event';\r\nimport states from '../states';\r\nimport actions from '../../actions';\r\n\r\nconst down = (store) => {\r\n  store.dispatch(actions.keyboard.reset(true));\r\n  if (store.getState().get('lock')) {\r\n    return;\r\n  }\r\n  if (store.getState().get('cur') !== null) {\r\n    event.down({\r\n      key: 'r',\r\n      once: true,\r\n      callback: () => {\r\n        states.overStart();\r\n      },\r\n    });\r\n  } else {\r\n    event.down({\r\n      key: 'r',\r\n      once: true,\r\n      callback: () => {\r\n        if (store.getState().get('lock')) {\r\n          return;\r\n        }\r\n        states.start();\r\n      },\r\n    });\r\n  }\r\n};\r\n\r\nconst up = (store) => {\r\n  store.dispatch(actions.keyboard.reset(false));\r\n  event.up({\r\n    key: 'r',\r\n  });\r\n};\r\n\r\nexport default {\r\n  down,\r\n  up,\r\n};\r\n","import event from '../../unit/event';\r\nimport states from '../states';\r\nimport actions from '../../actions';\r\n\r\nconst down = (store) => {\r\n  store.dispatch(actions.keyboard.pause(true));\r\n  event.down({\r\n    key: 'p',\r\n    once: true,\r\n    callback: () => {\r\n      const state = store.getState();\r\n      if (state.get('lock')) {\r\n        return;\r\n      }\r\n      const cur = state.get('cur');\r\n      const isPause = state.get('pause');\r\n      if (cur !== null) {\r\n        states.pause(!isPause);\r\n      } else {\r\n        states.start();\r\n      }\r\n    },\r\n  });\r\n};\r\n\r\nconst up = (store) => {\r\n  store.dispatch(actions.keyboard.pause(false));\r\n  event.up({\r\n    key: 'p',\r\n  });\r\n};\r\n\r\n\r\nexport default {\r\n  down,\r\n  up,\r\n};\r\n","import event from '../../unit/event';\r\nimport actions from '../../actions';\r\n\r\nconst down = (store) => {\r\n  store.dispatch(actions.keyboard.music(true));\r\n  if (store.getState().get('lock')) {\r\n    return;\r\n  }\r\n  event.down({\r\n    key: 's',\r\n    once: true,\r\n    callback: () => {\r\n      if (store.getState().get('lock')) {\r\n        return;\r\n      }\r\n      store.dispatch(actions.music(!store.getState().get('music')));\r\n    },\r\n  });\r\n};\r\n\r\nconst up = (store) => {\r\n  store.dispatch(actions.keyboard.music(false));\r\n  event.up({\r\n    key: 's',\r\n  });\r\n};\r\n\r\n\r\nexport default {\r\n  down,\r\n  up,\r\n};\r\n","import React from 'react';\r\nimport Immutable from 'immutable';\r\nimport propTypes from 'prop-types';\r\n\r\nimport './index.css';\r\nimport Button from './button';\r\nimport store from '../../store';\r\nimport todo from '../../control/todo';\r\n\r\nexport default class Keyboard extends React.Component {\r\n  componentDidMount() {\r\n    const touchEventCatch = {};\r\n\r\n    const mouseDownEventCatch = {};\r\n    document.addEventListener('touchstart', (e) => {\r\n      if (e.preventDefault) {\r\n        e.preventDefault();\r\n      }\r\n    }, true);\r\n\r\n    document.addEventListener('touchend', (e) => {\r\n      if (e.preventDefault) {\r\n        e.preventDefault();\r\n      }\r\n    }, true);\r\n\r\n    document.addEventListener('gesturestart', (e) => {\r\n      if (e.preventDefault) {\r\n        e.preventDefault();\r\n      }\r\n    });\r\n\r\n    document.addEventListener('mousedown', (e) => {\r\n      if (e.preventDefault) {\r\n        e.preventDefault();\r\n      }\r\n    }, true);\r\n\r\n    Object.keys(todo).forEach((key) => {\r\n      this[`dom_${key}`].dom.addEventListener('mousedown', () => {\r\n        if (touchEventCatch[key] === true) {\r\n          return;\r\n        }\r\n        todo[key].down(store);\r\n        mouseDownEventCatch[key] = true;\r\n      }, true);\r\n      this[`dom_${key}`].dom.addEventListener('mouseup', () => {\r\n        if (touchEventCatch[key] === true) {\r\n          touchEventCatch[key] = false;\r\n          return;\r\n        }\r\n        todo[key].up(store);\r\n        mouseDownEventCatch[key] = false;\r\n      }, true);\r\n      this[`dom_${key}`].dom.addEventListener('mouseout', () => {\r\n        if (mouseDownEventCatch[key] === true) {\r\n          todo[key].up(store);\r\n        }\r\n      }, true);\r\n      this[`dom_${key}`].dom.addEventListener('touchstart', () => {\r\n        touchEventCatch[key] = true;\r\n        todo[key].down(store);\r\n      }, true);\r\n      this[`dom_${key}`].dom.addEventListener('touchend', () => {\r\n        todo[key].up(store);\r\n      }, true);\r\n    });\r\n  }\r\n\r\n  shouldComponentUpdate({ keyboard, filling }) {\r\n    return !Immutable.is(keyboard, this.props.keyboard) || filling !== this.props.filling;\r\n  }\r\n\r\n  render() {\r\n    const keyboard = this.props.keyboard;\r\n    return (\r\n        <div\r\n            className=\"keyboard\"\r\n            style={{\r\n              marginTop: 20 + this.props.filling,\r\n            }}\r\n        >\r\n          <Button\r\n              color=\"blue\"\r\n              size=\"s1\"\r\n              top={0}\r\n              left={374}\r\n              label={'Rotation'}\r\n              arrow=\"translate(0, 63px)\"\r\n              position\r\n              active={keyboard.get('rotate')}\r\n              ref={(c) => { this.dom_rotate = c; }}\r\n          />\r\n          <Button\r\n              color=\"blue\"\r\n              size=\"s1\"\r\n              top={180}\r\n              left={374}\r\n              label={'Down'}\r\n              arrow=\"translate(0,-71px) rotate(180deg)\"\r\n              active={keyboard.get('down')}\r\n              ref={(c) => { this.dom_down = c; }}\r\n          />\r\n          <Button\r\n              color=\"blue\"\r\n              size=\"s1\"\r\n              top={90}\r\n              left={284}\r\n              label={'Left'}\r\n              arrow=\"translate(60px, -12px) rotate(270deg)\"\r\n              active={keyboard.get('left')}\r\n              ref={(c) => { this.dom_left = c; }}\r\n          />\r\n          <Button\r\n              color=\"blue\"\r\n              size=\"s1\"\r\n              top={90}\r\n              left={464}\r\n              label={'Right'}\r\n              arrow=\"translate(-60px, -12px) rotate(90deg)\"\r\n              active={keyboard.get('right')}\r\n              ref={(c) => { this.dom_right = c; }}\r\n          />\r\n          <Button\r\n              color=\"blue\"\r\n              size=\"s0\"\r\n              top={100}\r\n              left={52}\r\n              label={`Drop (SPACE)`}\r\n              active={keyboard.get('drop')}\r\n              ref={(c) => { this.dom_space = c; }}\r\n          />\r\n          <Button\r\n              color=\"red\"\r\n              size=\"s2\"\r\n              top={0}\r\n              left={196}\r\n              label={`Reset(R)`}\r\n              active={keyboard.get('reset')}\r\n              ref={(c) => { this.dom_r = c; }}\r\n          />\r\n          <Button\r\n              color=\"green\"\r\n              size=\"s2\"\r\n              top={0}\r\n              left={106}\r\n              label={`Sound(S)`}\r\n              active={keyboard.get('music')}\r\n              ref={(c) => { this.dom_s = c; }}\r\n          />\r\n          <Button\r\n              color=\"green\"\r\n              size=\"s2\"\r\n              top={0}\r\n              left={16}\r\n              label={`Pause(P)`}\r\n              active={keyboard.get('pause')}\r\n              ref={(c) => { this.dom_p = c; }}\r\n          />\r\n        </div>\r\n    );\r\n  }\r\n}\r\n\r\nKeyboard.propTypes = {\r\n  filling: propTypes.number.isRequired,\r\n  keyboard: propTypes.object.isRequired,\r\n};\r\n","import React from 'react';\r\nimport { connect } from 'react-redux';\r\nimport classnames from 'classnames';\r\nimport propTypes from 'prop-types';\r\n\r\nimport './tetris.css';\r\nimport './loader.css';\r\nimport Matrix from './components/matrix';\r\nimport Decorate from './components/decorate';\r\nimport Number from './components/number';\r\nimport Next from './components/next';\r\nimport Music from './components/music';\r\nimport Pause from './components/pause';\r\nimport Point from './components/point';\r\nimport Logo from './components/logo';\r\nimport Keyboard from './components/keyboard';\r\n\r\nimport { transform, lastRecord, speeds} from './unit/const';\r\nimport { visibilityChangeEvent, isFocus } from './unit/';\r\nimport states from './control/states';\r\n\r\nclass Tetris extends React.Component {\r\n    state = {\r\n        w: document.documentElement.clientWidth,\r\n        h: document.documentElement.clientHeight,\r\n    };\r\n\r\n    componentWillMount() {\r\n        window.addEventListener('resize', this.resize.bind(this), true);\r\n    }\r\n\r\n    componentDidMount() {\r\n        if (visibilityChangeEvent) {\r\n            document.addEventListener(visibilityChangeEvent, () => {\r\n                states.focus(isFocus());\r\n            }, false);\r\n        }\r\n\r\n        if (lastRecord) { // 读取记录\r\n            if (lastRecord.cur && !lastRecord.pause) {\r\n                const speedRun = this.props.speedRun;\r\n                let timeout = speeds[speedRun - 1] / 2;\r\n                timeout = speedRun < speeds[speeds.length - 1] ? speeds[speeds.length - 1] : speedRun;\r\n                states.auto(timeout);\r\n            }\r\n            if (!lastRecord.cur) {\r\n                states.overStart();\r\n            }\r\n        } else {\r\n            states.overStart();\r\n        }\r\n    }\r\n\r\n    resize() {\r\n        this.setState({\r\n            w: document.documentElement.clientWidth,\r\n            h: document.documentElement.clientHeight,\r\n        });\r\n    }\r\n\r\n    render() {\r\n        let filling = 0;\r\n        const size = (() => {\r\n            const w = this.state.w;\r\n            const h = this.state.h;\r\n            const ratio = h / w;\r\n            let scale;\r\n            let css = {};\r\n            if (ratio < 1.5) {\r\n                scale = h / 960;\r\n            } else {\r\n                scale = w / 640;\r\n                filling = (h - (960 * scale)) / scale / 3;\r\n                css = {\r\n                    paddingTop: Math.floor(filling) + 42,\r\n                    paddingBottom: Math.floor(filling),\r\n                    marginTop: Math.floor(-480 - (filling * 1.5)),\r\n                };\r\n            }\r\n            css[transform] = `scale(${scale})`;\r\n            return css;\r\n        })();\r\n\r\n        return (\r\n            <div\r\n                className=\"app\"\r\n                style={size}\r\n            >\r\n                <div className={classnames({'rect': true, 'drop': this.props.drop })}>\r\n                    <Decorate />\r\n                    <div className=\"screen\">\r\n                        <div className=\"panel\">\r\n                            <Matrix\r\n                                matrix={this.props.matrix}\r\n                                cur={this.props.cur}\r\n                                reset={this.props.reset}\r\n                            />\r\n                            <Logo cur={!!this.props.cur} reset={this.props.reset} />\r\n                            <div className=\"state\">\r\n                                <Point cur={!!this.props.cur} point={this.props.points} max={this.props.max} />\r\n                                <p>{ this.props.cur ? 'Cleans' : 'Start Line' }</p>\r\n                                <Number number={this.props.cur ? this.props.clearLines : this.props.startLines} />\r\n                                <p>{'Level'}</p>\r\n                                <Number\r\n                                    number={this.props.cur ? this.props.speedRun : this.props.speedStart}\r\n                                    length={1}\r\n                                />\r\n                                <p>{'Next'}</p>\r\n                                <Next data={this.props.next} />\r\n                                <div className=\"bottom\">\r\n                                    <Music data={this.props.music} />\r\n                                    <Pause data={this.props.pause} />\r\n                                    <Number time />\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <Keyboard filling={filling} keyboard={this.props.keyboard} />\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nTetris.propTypes = {\r\n    music: propTypes.bool.isRequired,\r\n    pause: propTypes.bool.isRequired,\r\n    matrix: propTypes.object.isRequired,\r\n    next: propTypes.string.isRequired,\r\n    cur: propTypes.object,\r\n    dispatch: propTypes.func.isRequired,\r\n    speedStart: propTypes.number.isRequired,\r\n    speedRun: propTypes.number.isRequired,\r\n    startLines: propTypes.number.isRequired,\r\n    clearLines: propTypes.number.isRequired,\r\n    points: propTypes.number.isRequired,\r\n    max: propTypes.number.isRequired,\r\n    reset: propTypes.bool.isRequired,\r\n    drop: propTypes.bool.isRequired,\r\n    keyboard: propTypes.object.isRequired,\r\n};\r\n\r\nconst mapStateToProps = (state) => ({\r\n    pause: state.get('pause'),\r\n    music: state.get('music'),\r\n    matrix: state.get('matrix'),\r\n    next: state.get('next'),\r\n    cur: state.get('cur'),\r\n    speedStart: state.get('speedStart'),\r\n    speedRun: state.get('speedRun'),\r\n    startLines: state.get('startLines'),\r\n    clearLines: state.get('clearLines'),\r\n    points: state.get('points'),\r\n    max: state.get('max'),\r\n    reset: state.get('reset'),\r\n    drop: state.get('drop'),\r\n    keyboard: state.get('keyboard'),\r\n});\r\n\r\nexport default connect(mapStateToProps)(Tetris);\r\n","import React from 'react';\nimport { View, Panel, PanelHeader, PanelHeaderContent, HeaderButton, platform, IOS } from '@vkontakte/vkui';\nimport '@vkontakte/vkui/dist/vkui.css';\nimport './assets/css/app.css';\nimport Icon28Menu from '@vkontakte/icons/dist/28/menu';\nimport Icon24Services from '@vkontakte/icons/dist/24/services';\nimport Icon36Article from '@vkontakte/icons/dist/36/article';\n\nimport Tetris from \"./Tetris\";\n\nfunction App() {\n    const osname = platform();\n\n    return (\n        <View activePanel=\"main\">\n            <Panel id=\"main\">\n                <PanelHeader left={\n                    <HeaderButton>\n                        {\n                            osname === IOS ? <Icon28Menu /> : <Icon36Article />\n                        }\n                    </HeaderButton>\n                }>\n                    <PanelHeaderContent>\n                        Tetris\n                    </PanelHeaderContent>\n                </PanelHeader>\n                <Tetris />\n            </Panel>\n        </View>\n    );\n}\n\nexport default App;\n","import store from '../store';\r\nimport todo from './todo';\r\n\r\nconst keyboard = {\r\n  37: 'left',\r\n  38: 'rotate',\r\n  39: 'right',\r\n  40: 'down',\r\n  32: 'space',\r\n  83: 's',\r\n  82: 'r',\r\n  80: 'p',\r\n};\r\n\r\nlet keydownActive;\r\n\r\nconst boardKeys = Object.keys(keyboard).map(e => parseInt(e, 10));\r\n\r\nconst keyDown = (e) => {\r\n  if (e.metaKey === true || boardKeys.indexOf(e.keyCode) === -1) {\r\n    return;\r\n  }\r\n  const type = keyboard[e.keyCode];\r\n  if (type === keydownActive) {\r\n    return;\r\n  }\r\n  keydownActive = type;\r\n  todo[type].down(store);\r\n};\r\n\r\nconst keyUp = (e) => {\r\n  if (e.metaKey === true || boardKeys.indexOf(e.keyCode) === -1) {\r\n    return;\r\n  }\r\n  const type = keyboard[e.keyCode];\r\n  if (type === keydownActive) {\r\n    keydownActive = '';\r\n  }\r\n  todo[type].up(store);\r\n};\r\n\r\ndocument.addEventListener('keydown', keyDown, true);\r\ndocument.addEventListener('keyup', keyUp, true);\r\n\r\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\nimport connect from '@vkontakte/vk-connect';\nimport { Provider } from 'react-redux';\nimport store from './store';\nimport './unit/const';\nimport './control';\nimport { subscribeRecord } from './unit';\n\nconnect.send('VKWebAppInit', {});\n\nsubscribeRecord(store);\n\nReactDOM.render(\n    <Provider store={store}>\n        <App />\n    </Provider>, document.getElementById('root')\n);\n\n"],"sourceRoot":""}